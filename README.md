# VBAProceduresIndexer

## このプロジェクトの目標

わたくし kazurayam は仕事としてMicrosoft Excelでアプリケーションをいくつか作った。ワークブック・ファイルに Visual Basic for Application 言語（以下、VBAと略記する）でコードを書いた。kazurayamはJava言語でのプログラミングには30年以上の経験があるが、VBAの経験がほとんどなかった。VBAでコードを書きながら「VBAって、なんて難しいんだ」と頭を抱えることが何度もあった。このVBAProceduresIndexerプロジェクトはkazurayamが経験したVBAの難問のひとつを取り上げて解決策を提供することを目標としている。

ひとつのアプリケーションを実現するのには、ひとつのxlsmファイルを作り、その中にすべてのVBAコード(SubやFunc)を格納するのがいちばんシンプルでやりやすい。しかしアプリケーションを２つ、３つと開発してみるとすぐわかる。３つのアプリすべてで同じSubやFuncを使いたくなる。VBAコードをコピー＆ペーストして３つのxlsmファイルに挿入するというやり方がひとつ可能ではある。しかしDon't Repeat Yourselfの原則を破ることになる。気持ち悪くてたまらない。だから共通モジュールを別個のxlsmファイルに括り出してライブラリ化した。ライブラリからxlmaファイル(Microsoft用語でAddinという)を作った。アプリケーションとしてのxlsmファイルがAddinに収められたSubやFunctionを参照する構成にした。このやり方はVBAプログラミングの常道であり、珍しくもなんともない。そうやってkazurayamはライブラリとしてのxlsmファイルを３つとアプリケーションとしてのxlsmファイルを４つ作った。具体的にファイル名を下記にあげておこう。

![関連図](https://kazurayam.github.io/VBAProceduresIndexer/diagrams/out/ExcelFiles/事務局Excelブック関連図.png)








