# VBAProceduresIndexer

## このプロジェクトの目標

わたくし kazurayam は仕事としてMicrosoft Excelでアプリケーションをいくつか作った。ワークブック・ファイルに Visual Basic for Application 言語（以下、VBAと略記する）でコードを書いた。その仕事の中でkazurayamはいくつかVBAの難問にぶち当たった。この VBAProceduresIndexer プロジェクトはkazurayamが経験したVBAの難問のひとつを取り上げて解決することを目標としている。その難問とは何か？そこから説明を始めよう。

ひとつのアプリケーションを実現するのに、ひとつのxlsmファイルを作り、その中にすべてのVBAコード(SubやFunc)を格納するのが単純で実現しやすい。しかしアプリケーションを２つ、３つと開発してみるとすぐわかる。３つのアプリすべてで似たようなSubやFuncを使いたくなるのだ。ひとつのxlsmファイルにおいて書いたVBAコードをコピーして別のxlsmファイルに挿入するというやり方が可能ではある。しかしDon't Repeat Yourselfの原則を破ることになる。プロフェッショナルなプログラマとして気持ち悪くてたまらない。だから共通モジュールを別個のxlsmファイルに括り出してライブラリ化した。ライブラリとしてのxlsmファイルからxlaファイルを生成した。これをMicrosoft用語ではAddinという。アプリケーションとしてのxlsmファイルがAddinの中のSubやFunctionを参照する構成にした。このやり方は珍しくもない。VBAプログラミングの教科書にちゃんと書いてる。そうやってkazurayamはライブラリとしてのxlsmファイルを３つとアプリケーションとしてのxlsmファイルを４つ作った。イメージを明確にするために具体的なファイル名を下記にあげておこう。

![関連図](https://kazurayam.github.io/VBAProceduresIndexer/diagrams/out/ExcelFiles/事務局Excelブック関連図.png)

`kazurayam_vba_lib` というのがGitHubレポジトリの名前で、その中に `Backboneライブラリ.xlsm` というExcelワークブックファイルがある、と了解してほしい。

さて、全部の7つのxslmファイルがあって、その中にたくさんのモジュールやクラスがある。そしてそのモジュールがたくさんのSubとFunctionを宣言している。いったいいくつ、kazurayamはSubとFunctionを作ったろうか？ここに全部列挙してみよう。2024年7月末の時点でこうだ。

(TODO)

けっこうな数のSubとFuncをkazurayamが作ってしまったことを了解してほしい。 さて、ここからが本当の問題です。

kazurayamが7つのxlsmファイルの中に作り込んだたくさんのSubとFuncの大半は、アプリケーションの機能を実現するのに必要なものです。しかし全部が必要なものかといえばそうではない。ゴミが混じっているのだ。VBA初心者のkazurayamがVBAを習うためだけに書いたSubが残っている、とか。Subをひとつ作っている途中で名前を変更したくなったが、ちょっと訳があって、新しい名前のSubを別に作った、そして古いSubを削除するのを怠ったから残っている、とか。理由はともかく、ゴミを探し出して削除したい。ところがVBA言語の開発環境は貧弱なので、一つ一つのSubがゴミかゴミでないかを見分ける手段を提供してくれない。困った。






## docs

https://kazurayam.github.io/VBAProceduresIndexer/



